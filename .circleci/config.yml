version: 2.1

workflows:
  build-and-deploy-to-heroku:
    jobs:
      - build-and-test
jobs:
  build-and-test:
    docker:
      - image: cimg/base:2021.04
    steps:
      - checkout
      - run: 
          command: |
            sudo apt-get update; \
            sudo apt-get install -y apt-transport-https && \
            sudo apt-get update && \
            sudo apt-get install -y dotnet-sdk-5.0
      - setup_remote_docker
      - run:
          name: "Build albumcollection image and sql server image"
          command: |
            docker-compose build --pull
